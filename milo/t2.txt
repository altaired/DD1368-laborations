----------------------------------------------
 
TASK 2:



WITH sea AS(
  SELECT city.name AS city, geo_sea.sea,
  city.province AS province,
  city.population AS population
  FROM city, geo_sea
  WHERE city.province = geo_sea.province
  ORDER BY city
),

lake AS(
  SELECT city.name AS city, geo_lake.lake,
  city.province AS province,
  city.population
  FROM city, geo_lake
  WHERE city.province = geo_lake.province
  ORDER BY city
),

river AS(
  SELECT city.name AS city, geo_river.river,
  city.province AS province,
  city.population
  FROM city, geo_river
  WHERE city.province = geo_river.province
  ORDER BY city
)

ONLY GIVES US THE CITYS WITH ALL OF THEM!

SELECT sea.city, sea.province, sea.population, sea.sea, lake.lake, river.river
FROM sea
JOIN lake ON sea.city = lake.city
JOIN river ON sea.city = river.city
WHERE sea.population > 3000000


ACTS WEID!

SELECT *
FROM sea
WHERE sea.population > 3000000
UNION
SELECT *
FROM lake
WHERE lake.population > 3000000
UNION
SELECT *
FROM river
WHERE river.population > 3000000


---------
WITH sea AS(
  SELECT geo_sea.sea, geo_sea.province
  FROM geo_sea
), lake AS(
  SELECT geo_lake.lake, geo_lake.province
  FROM geo_lake
), river AS(
  SELECT geo_river.river, geo_river.province
  FROM geo_river
), cities AS(
  SELECT city.name AS city, city.province, city.population
  FROM city
  WHERE city.population > 3000000
)

SELECT cities.city, cities.province 
sea.sea, sea.province, 
lake.lake, lake.province, 
river.river, river.province
FROM cities, sea, lake, river
WHERE cities.province <> sea.province
OR cities.province <> lake.province
OR cities.province <> river.province

------------

SELECT *
FROM cities
WHERE cities NOT IN(
  SELECT *
  FROM sea
  UNION
  SELECT *
  FROM lake
  UNION
  SELECT *
  FROM river
)

------
 WITH sea AS(
  SELECT geo_sea.sea, geo_sea.province
  FROM geo_sea
), lake AS(
  SELECT geo_lake.lake, geo_lake.province
  FROM geo_lake
), river AS(
  SELECT geo_river.river, geo_river.province
  FROM geo_river
), cities AS(
  SELECT city.name AS city, city.province, city.population
  FROM city
  WHERE city.population > 3000000
)
SELECT *
FROM cities
WHERE cities.province NOT IN(
  SELECT province
  FROM sea
  UNION ALL
  SELECT province
  FROM lake
  UNION ALL
  SELECT province
  FROM river
);
    city     |     province      | population
-------------+-------------------+------------
 Madrid      | Madrid            |    3198645
 Moskva      | Moscow            |   11979529
 Ankara      | Ankara            |    4630735
 Taiyuan     | Shanxi            |    3426519
 Beijing     | Beijing           |   11716620
 Tianjin     | Tianjin           |   11090314
 Mashhad     | Khorasan-e-Razavi |    3001184
 Tehran      | Tehran            |    8693706
 Riyadh      | Al-Riyadh         |    4087152
 Kano        | Kano              |    4155000
 Ibadan      | Oyo               |    3160000
 Addis Ababa | Addis Ababa       |    3040740
